<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÉ Halloween Math Challenge! üëª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Comic Neue', cursive;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: white;
        }

        .container {
            background: linear-gradient(135deg, #2d1b69 0%, #1a0e3e 100%);
            border-radius: 30px;
            padding: 40px;
            max-width: 1000px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(255, 140, 0, 0.4);
            border: 3px solid #ff8c00;
        }

        h1 {
            color: #ff8c00;
            text-align: center;
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
        }

        .start-screen {
            text-align: center;
        }

        .difficulty-selection {
            margin: 30px 0;
        }

        .difficulty-selection h2 {
            color: #ff8c00;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .difficulty-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .diff-btn {
            padding: 20px 30px;
            font-size: 1.3em;
            border: 3px solid #ff8c00;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            font-family: inherit;
            transition: all 0.3s;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
        }

        .diff-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px #ff8c00;
        }

        .operation-selection {
            margin: 30px 0;
        }

        .operation-selection h2 {
            color: #9d4edd;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .op-btn {
            padding: 20px 40px;
            font-size: 1.5em;
            border: 3px solid #9d4edd;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            font-family: inherit;
            transition: all 0.3s;
            background: linear-gradient(135deg, #9d4edd 0%, #7b2cbf 100%);
            color: white;
            margin: 10px;
        }

        .op-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px #9d4edd;
        }

        .btn {
            padding: 20px 50px;
            font-size: 1.5em;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            font-family: inherit;
            transition: all 0.3s;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 140, 0, 0.5);
        }

        .game-screen {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            gap: 15px;
            flex-wrap: wrap;
        }

        .stat-box {
            padding: 15px 20px;
            border-radius: 15px;
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            text-align: center;
            flex: 1;
            min-width: 120px;
        }

        .stat-box.purple {
            background: linear-gradient(135deg, #9d4edd 0%, #7b2cbf 100%);
        }

        .stat-box h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-box p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .timer-box {
            background: linear-gradient(135deg, #e63946 0%, #c1121f 100%);
            font-size: 2.5em;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .timer-box.warning {
            animation: shake 0.5s ease-in-out infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .problem-display {
            background: linear-gradient(135deg, #2d1b69 0%, #1a0e3e 100%);
            border: 4px solid #ff8c00;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
        }

        .problem-text {
            font-size: 4em;
            margin-bottom: 30px;
            color: #ff8c00;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .answer-input {
            font-size: 3em;
            padding: 20px;
            border: 4px solid #9d4edd;
            border-radius: 15px;
            background: white;
            color: #1a0e3e;
            text-align: center;
            font-weight: bold;
            font-family: inherit;
            width: 250px;
            max-width: 100%;
        }

        .answer-input:focus {
            outline: none;
            border-color: #ff8c00;
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.5);
        }

        .feedback {
            font-size: 2em;
            margin: 20px 0;
            min-height: 60px;
            font-weight: bold;
            text-align: center;
        }

        .feedback.correct {
            color: #06ffa5;
            animation: bounce 0.5s;
        }

        .feedback.incorrect {
            color: #e63946;
            animation: shake 0.5s;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .collection-display {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 20px 0;
            font-size: 1.5em;
        }

        .collection-item {
            text-align: center;
        }

        .collection-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .results-screen {
            text-align: center;
            padding: 20px;
        }

        .results-screen h2 {
            font-size: 3em;
            color: #ff8c00;
            margin-bottom: 30px;
        }

        .results-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .result-card {
            background: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);
            padding: 25px;
            border-radius: 20px;
            border: 3px solid #ffa500;
        }

        .result-card h3 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .result-card p {
            font-size: 1.2em;
        }

        .badges-display {
            margin: 30px 0;
        }

        .badges-display h3 {
            font-size: 2em;
            color: #9d4edd;
            margin-bottom: 20px;
        }

        .badges-grid {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .badge {
            background: linear-gradient(135deg, #9d4edd 0%, #7b2cbf 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            min-width: 150px;
            border: 3px solid #c77dff;
        }

        .badge-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .badge-name {
            font-size: 1.1em;
            font-weight: bold;
        }

        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti {
            position: absolute;
            font-size: 2em;
            animation: fall 3s linear;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .streak-display {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: 8em;
            z-index: 1001;
            animation: popup 0.8s ease-out;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.5);
        }

        @keyframes popup {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .hidden {
            display: none;
        }

        .progress-container {
            margin: 20px 0;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            height: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #06ffa5 0%, #00d4a1 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .character-display {
            font-size: 6em;
            text-align: center;
            margin: 20px 0;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .daily-stats {
            background: linear-gradient(135deg, #2d1b69 0%, #1a0e3e 100%);
            border: 3px solid #9d4edd;
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
        }

        .daily-stats h3 {
            color: #9d4edd;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .daily-stat-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÉ Halloween Math Challenge! üëª</h1>

        <div id="startScreen" class="start-screen">
            <div class="character-display">üéÉ</div>

            <div class="difficulty-selection">
                <h2>Choose Your Spooky Level! üëª</h2>
                <div class="difficulty-buttons">
                    <button class="diff-btn" onclick="selectDifficulty('easy')">
                        ü¶á Friendly Bats<br><small>Single Digit (0-9)</small>
                    </button>
                    <button class="diff-btn" onclick="selectDifficulty('medium')">
                        üï∑Ô∏è Spider Webs<br><small>Crossing 10s</small>
                    </button>
                    <button class="diff-btn" onclick="selectDifficulty('hard')">
                        üëª Haunted House<br><small>Double Digit (10-99)</small>
                    </button>
                </div>
            </div>

            <div class="operation-selection">
                <h2>Pick Your Potion! üß™</h2>
                <button class="op-btn" onclick="selectOperation('addition')">‚ûï Addition Potion</button>
                <button class="op-btn" onclick="selectOperation('subtraction')">‚ûñ Subtraction Spell</button>
                <button class="op-btn" onclick="selectOperation('both')">üé≠ Mixed Magic</button>
            </div>

            <div id="dailyStatsDisplay" class="daily-stats hidden">
                <h3>üìÖ Today's Haunted History</h3>
                <div id="dailyStatsList"></div>
            </div>

            <button class="btn" onclick="startGame()">üéÉ Start Spooky Drill! üéÉ</button>
        </div>

        <div id="gameScreen" class="game-screen hidden">
            <div class="stats-bar">
                <div class="stat-box">
                    <h3 id="problemCount">0</h3>
                    <p>üëª Problems</p>
                </div>
                <div class="stat-box purple">
                    <h3 id="correctCount">0</h3>
                    <p>‚úÖ Correct</p>
                </div>
                <div class="stat-box">
                    <h3 id="streakCount">0</h3>
                    <p>üî• Streak</p>
                </div>
            </div>

            <div class="timer-box" id="timerDisplay">2:00</div>

            <div class="collection-display">
                <div class="collection-item">
                    <div class="collection-icon">üéÉ</div>
                    <div id="pumpkinCount">0</div>
                </div>
                <div class="collection-item">
                    <div class="collection-icon">üç¨</div>
                    <div id="candyCount">0</div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill">0%</div>
                </div>
            </div>

            <div class="problem-display">
                <div class="problem-text" id="problemText">5 + 3 = ?</div>
                <input type="number" id="answerInput" class="answer-input" placeholder="?" autofocus>
            </div>

            <div class="feedback" id="feedback"></div>
        </div>

        <div id="resultsScreen" class="results-screen hidden">
            <h2>üéÉ Spooky Results! üëª</h2>

            <div class="character-display" id="resultCharacter">üéÉ</div>

            <div class="results-stats">
                <div class="result-card">
                    <h3 id="totalProblems">0</h3>
                    <p>Total Problems</p>
                </div>
                <div class="result-card">
                    <h3 id="totalCorrect">0</h3>
                    <p>Correct Answers</p>
                </div>
                <div class="result-card">
                    <h3 id="accuracyPercent">0%</h3>
                    <p>Accuracy</p>
                </div>
                <div class="result-card">
                    <h3 id="avgTime">0s</h3>
                    <p>Avg Time/Problem</p>
                </div>
                <div class="result-card">
                    <h3 id="maxStreak">0</h3>
                    <p>Best Streak</p>
                </div>
                <div class="result-card">
                    <h3 id="totalCandy">0</h3>
                    <p>üç¨ Candy Collected</p>
                </div>
            </div>

            <div class="badges-display" id="badgesDisplay">
                <h3>üèÜ Halloween Achievements! üèÜ</h3>
                <div class="badges-grid" id="badgesGrid"></div>
            </div>

            <button class="btn" onclick="resetGame()">üéÉ Try Again! üéÉ</button>
        </div>
    </div>

    <div class="celebration" id="celebration"></div>

    <script>
        // Game state
        let difficulty = 'easy';
        let operation = 'addition';
        let timeRemaining = 120; // 2 minutes
        let timerInterval = null;
        let currentProblem = null;
        let problemCount = 0;
        let correctCount = 0;
        let currentStreak = 0;
        let maxStreak = 0;
        let pumpkins = 0;
        let candy = 0;
        let problemTimes = [];
        let startTime = null;

        // Daily stats (stored in localStorage)
        const dailyStats = [];

        // Badge definitions
        const badges = [
            { id: 'ghost_hunter', name: 'Ghost Hunter', icon: 'üëª', condition: (stats) => stats.correct >= 10 },
            { id: 'pumpkin_king', name: 'Pumpkin King', icon: 'üéÉ', condition: (stats) => stats.pumpkins >= 5 },
            { id: 'candy_collector', name: 'Candy Collector', icon: 'üç¨', condition: (stats) => stats.candy >= 10 },
            { id: 'speed_demon', name: 'Speed Demon', icon: '‚ö°', condition: (stats) => stats.avgTime < 3 },
            { id: 'accuracy_ace', name: 'Accuracy Ace', icon: 'üéØ', condition: (stats) => stats.accuracy >= 90 },
            { id: 'streak_master', name: 'Streak Master', icon: 'üî•', condition: (stats) => stats.maxStreak >= 5 },
            { id: 'haunted_hero', name: 'Haunted Hero', icon: 'ü¶∏', condition: (stats) => stats.correct >= 20 },
            { id: 'witch_wizard', name: 'Witch Wizard', icon: 'üßô', condition: (stats) => stats.accuracy >= 95 },
            { id: 'bat_master', name: 'Bat Master', icon: 'ü¶á', condition: (stats) => stats.maxStreak >= 10 },
        ];

        function selectDifficulty(level) {
            difficulty = level;
            document.querySelectorAll('.diff-btn').forEach(btn => {
                btn.style.opacity = '0.5';
            });
            event.target.style.opacity = '1';
        }

        function selectOperation(op) {
            operation = op;
            document.querySelectorAll('.op-btn').forEach(btn => {
                btn.style.opacity = '0.5';
            });
            event.target.style.opacity = '1';
        }

        function generateProblem() {
            let num1, num2, answer, operatorSymbol;
            const currentOp = operation === 'both' ? (Math.random() < 0.5 ? 'addition' : 'subtraction') : operation;

            if (difficulty === 'easy') {
                num1 = Math.floor(Math.random() * 10);
                num2 = Math.floor(Math.random() * 10);
            } else if (difficulty === 'medium') {
                // Crossing 10s
                num1 = Math.floor(Math.random() * 10) + 5;
                num2 = Math.floor(Math.random() * 10) + 5;
            } else {
                // Double digit
                num1 = Math.floor(Math.random() * 90) + 10;
                num2 = Math.floor(Math.random() * 90) + 10;
            }

            if (currentOp === 'addition') {
                answer = num1 + num2;
                operatorSymbol = '+';
            } else {
                // Ensure positive result for subtraction
                if (num1 < num2) {
                    [num1, num2] = [num2, num1];
                }
                answer = num1 - num2;
                operatorSymbol = '-';
            }

            return { num1, num2, answer, operator: operatorSymbol };
        }

        function startGame() {
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');

            // Reset game state
            timeRemaining = 120;
            problemCount = 0;
            correctCount = 0;
            currentStreak = 0;
            maxStreak = 0;
            pumpkins = 0;
            candy = 0;
            problemTimes = [];

            updateDisplay();
            nextProblem();
            startTimer();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();

                if (timeRemaining <= 30) {
                    document.getElementById('timerDisplay').classList.add('warning');
                }

                if (timeRemaining <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timerDisplay').textContent =
                `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function nextProblem() {
            currentProblem = generateProblem();
            document.getElementById('problemText').textContent =
                `${currentProblem.num1} ${currentProblem.operator} ${currentProblem.num2} = ?`;
            document.getElementById('answerInput').value = '';
            document.getElementById('answerInput').focus();
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';

            startTime = Date.now();
        }

        function checkAnswer() {
            const userAnswer = parseInt(document.getElementById('answerInput').value);

            if (isNaN(userAnswer)) return;

            const timeTaken = (Date.now() - startTime) / 1000;
            problemTimes.push(timeTaken);
            problemCount++;

            const feedback = document.getElementById('feedback');

            if (userAnswer === currentProblem.answer) {
                correctCount++;
                currentStreak++;
                candy++;

                if (currentStreak > maxStreak) {
                    maxStreak = currentStreak;
                }

                // Award pumpkins for streaks
                if (currentStreak % 3 === 0) {
                    pumpkins++;
                    showStreakCelebration();
                }

                feedback.textContent = getCorrectMessage();
                feedback.className = 'feedback correct';
                playSound('success');
                createHalloweenConfetti();
            } else {
                currentStreak = 0;
                feedback.textContent = getIncorrectMessage();
                feedback.className = 'feedback incorrect';
                playSound('error');
            }

            updateDisplay();
            setTimeout(nextProblem, 800);
        }

        function getCorrectMessage() {
            const messages = [
                'üéÉ Spooktacular! üéÉ',
                'üëª Boo-tiful! üëª',
                'ü¶á Batastic! ü¶á',
                'üç¨ Sweet Success! üç¨',
                '‚ö° Frightfully Fast! ‚ö°',
                'üßô Magical! üßô'
            ];
            return messages[Math.floor(Math.random() * messages.length)];
        }

        function getIncorrectMessage() {
            const messages = [
                'üíÄ Oops! Try again! üíÄ',
                'üï∑Ô∏è Not quite! üï∑Ô∏è',
                'ü¶¥ Almost there! ü¶¥',
                'üßü Keep going! üßü'
            ];
            return messages[Math.floor(Math.random() * messages.length)];
        }

        function updateDisplay() {
            document.getElementById('problemCount').textContent = problemCount;
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('streakCount').textContent = currentStreak;
            document.getElementById('pumpkinCount').textContent = pumpkins;
            document.getElementById('candyCount').textContent = candy;

            const accuracy = problemCount > 0 ? (correctCount / problemCount * 100) : 0;
            document.getElementById('progressFill').style.width = `${accuracy}%`;
            document.getElementById('progressFill').textContent = `${Math.round(accuracy)}%`;
        }

        function endGame() {
            clearInterval(timerInterval);
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');

            const accuracy = problemCount > 0 ? (correctCount / problemCount * 100) : 0;
            const avgTime = problemTimes.length > 0 ?
                problemTimes.reduce((a, b) => a + b, 0) / problemTimes.length : 0;

            const stats = {
                total: problemCount,
                correct: correctCount,
                accuracy: accuracy,
                avgTime: avgTime,
                maxStreak: maxStreak,
                pumpkins: pumpkins,
                candy: candy,
                difficulty: difficulty,
                operation: operation,
                timestamp: new Date().toISOString()
            };

            // Save to daily stats
            saveDailyStats(stats);

            // Display results
            document.getElementById('totalProblems').textContent = problemCount;
            document.getElementById('totalCorrect').textContent = correctCount;
            document.getElementById('accuracyPercent').textContent = `${Math.round(accuracy)}%`;
            document.getElementById('avgTime').textContent = `${avgTime.toFixed(1)}s`;
            document.getElementById('maxStreak').textContent = maxStreak;
            document.getElementById('totalCandy').textContent = candy;

            // Show character based on performance
            const resultChar = document.getElementById('resultCharacter');
            if (accuracy >= 90) {
                resultChar.textContent = 'üèÜ';
            } else if (accuracy >= 75) {
                resultChar.textContent = 'üéÉ';
            } else if (accuracy >= 50) {
                resultChar.textContent = 'üëª';
            } else {
                resultChar.textContent = 'ü¶á';
            }

            // Show earned badges
            displayBadges(stats);
            createMassiveConfetti();
        }

        function displayBadges(stats) {
            const badgesGrid = document.getElementById('badgesGrid');
            badgesGrid.innerHTML = '';

            const earnedBadges = badges.filter(badge => badge.condition(stats));

            if (earnedBadges.length === 0) {
                document.getElementById('badgesDisplay').classList.add('hidden');
                return;
            }

            document.getElementById('badgesDisplay').classList.remove('hidden');

            earnedBadges.forEach(badge => {
                const badgeEl = document.createElement('div');
                badgeEl.className = 'badge';
                badgeEl.innerHTML = `
                    <div class="badge-icon">${badge.icon}</div>
                    <div class="badge-name">${badge.name}</div>
                `;
                badgesGrid.appendChild(badgeEl);
            });
        }

        function saveDailyStats(stats) {
            const today = new Date().toDateString();
            let dailyData = JSON.parse(localStorage.getItem('halloweenMathDaily') || '{}');

            if (!dailyData[today]) {
                dailyData[today] = [];
            }

            dailyData[today].push(stats);
            localStorage.setItem('halloweenMathDaily', JSON.stringify(dailyData));
        }

        function loadDailyStats() {
            const today = new Date().toDateString();
            const dailyData = JSON.parse(localStorage.getItem('halloweenMathDaily') || '{}');

            if (dailyData[today] && dailyData[today].length > 0) {
                document.getElementById('dailyStatsDisplay').classList.remove('hidden');
                const statsList = document.getElementById('dailyStatsList');
                statsList.innerHTML = '';

                dailyData[today].forEach((stat, index) => {
                    const item = document.createElement('div');
                    item.className = 'daily-stat-item';
                    item.innerHTML = `
                        <span>Session ${index + 1}</span>
                        <span>${stat.correct}/${stat.total} - ${Math.round(stat.accuracy)}%</span>
                    `;
                    statsList.appendChild(item);
                });
            }
        }

        function createHalloweenConfetti() {
            const celebration = document.getElementById('celebration');
            const emojis = ['üéÉ', 'üëª', 'ü¶á', 'üç¨', 'üï∑Ô∏è', 'üíÄ', 'üßô', '‚ö°'];

            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.top = '-50px';
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    celebration.appendChild(confetti);

                    setTimeout(() => confetti.remove(), 3000);
                }, i * 50);
            }
        }

        function createMassiveConfetti() {
            const celebration = document.getElementById('celebration');
            const emojis = ['üéÉ', 'üëª', 'ü¶á', 'üç¨', 'üï∑Ô∏è', 'üíÄ', 'üßô', '‚ö°', 'ü¶¥', 'üßü'];

            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.top = '-50px';
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    celebration.appendChild(confetti);

                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        function showStreakCelebration() {
            const streakDisplay = document.createElement('div');
            streakDisplay.className = 'streak-display';
            streakDisplay.textContent = 'üî• STREAK! üî•';
            document.body.appendChild(streakDisplay);

            setTimeout(() => streakDisplay.remove(), 1500);
        }

        function playSound(type) {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            if (type === 'success') {
                oscillator.frequency.value = 523.25;
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } else if (type === 'error') {
                oscillator.frequency.value = 220;
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            }
        }

        function resetGame() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
            loadDailyStats();
        }

        // Setup answer input
        document.getElementById('answerInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        // Load daily stats on page load
        window.addEventListener('load', () => {
            loadDailyStats();
        });
    </script>
</body>
</html>
